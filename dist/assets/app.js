(()=>{var t,e={625:(t,e,a)=>{"use strict";a(563);var n=a(638);n((function(){n("form").parsley(),Parsley.addMessages("ru",{defaultMessage:"Некорректное значение.",type:{email:"Формат email-адреса некорректный",url:"Введите URL адрес.",number:"Введите число.",integer:"Введите целое число.",digits:"Введите только цифры.",alphanum:"Введите буквенно-цифровое значение."},notblank:"Это поле должно быть заполнено.",required:"Поле не заполнено",pattern:"Не использовать символы или цифры",min:"Это значение должно быть не менее чем %s.",max:"Это значение должно быть не более чем %s.",range:"Это значение должно быть от %s до %s.",minlength:"Пароль меньше %s символов",maxlength:"Это значение должно содержать не более %s символов.",length:"Неверный формат",mincheck:"Выберите не менее %s значений.",maxcheck:"Выберите не более %s значений.",check:"Выберите от %s до %s значений.",equalto:"Пароли не совпадают"}),Parsley.setLocale("ru")})),n((function(){var t=n("[data-search-form]");t.length&&t.find("input").on("change",(function(){n(this).val()?t.addClass("filled"):t.removeClass("filled")}))}));a(378),a(917);var o=a(638);function i(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function r(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){c(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function c(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var s={closeExisting:!0,touch:!1,hideScrollbar:!1,baseTpl:'<div class="fancybox-container" role="dialog" tabindex="-1"><div class="fancybox-bg"></div><div class="fancybox-stage"></div></div>',animationEffect:"zoom"};o((function(){o("[data-fancy-button]").on("click",(function(t){var e=r({},s);t.preventDefault();var a=o(this).data("fancy-button"),n=o('[data-fancy-modal="'.concat(a,'"]'));if("search"===a)e.animationEffect="top";o.fancybox.defaults=r(r({},o.fancybox.defaults),e),o.fancybox.open(n)}))}));a(490);var d=a(638);function l(t){t.each((function(){var t=d(this),e=t.closest(".select-wrapper"),a=getComputedStyle(e[0]),n=d(this).data("select-placeholder");"static"===a.position&&e.css("position","relative"),t.select2({dropdownParent:e,selectOnClose:!0,minimumResultsForSearch:1/0,placeholder:n}),t.on("select2:open",(function(){e.css("z-index","100000");var t=e.find(".select2-dropdown");t.hide();var a=setTimeout((function(){t.slideDown({duration:500}),clearTimeout(a)}),0)})),t.on("select2:closing",(function(a){a.preventDefault();var o=e.find(".select2-dropdown"),i=setTimeout((function(){e.css("z-index","");var a=e.find(".select2");a.addClass("closing"),a.removeClass("select2-container--open"),o.slideUp(500,(function(){var a=setTimeout((function(){t.select2("destroy"),t.select2({dropdownParent:e,selectOnClose:!0,minimumResultsForSearch:1/0,placeholder:n}),t.removeClass("closing"),e.css("z-index",""),clearTimeout(a)}),300)})),clearTimeout(i)}),0)}))}))}d((function(){l(d(".select__select"))}));a(526),a(309);var u=a(638);function f(){console.log(u(this).val()),u(this).closest(".select").removeClass("select--error")}var p=a(638);function v(t,e){var a=p(".panel");p("[data-alert-message]").text(e),a.addClass(t),a.addClass("show"),setTimeout((function(){a.removeClass("show"),setTimeout((function(){a.removeClass(t)}),500)}),2e3)}p((function(){var t,e,a,n;(t=p("[data-type]")).on("submit",(function(e){e.preventDefault();var a={subtasks:[],workspaceId:window.location.pathname.split("/")[2]},n=t.find("[data-select]"),o=t.find("[data-form-file]");if(!n.val())return n.closest(".select").addClass("select--error"),void n.one("change",f);a.status=n.val().toUpperCase(),t.find("[data-type=get-field]").each((function(){var t=p(this).attr("data-uf"),e=p(this).val();"subtasks"===t?e&&a[t].push(e):a[t]=e||null}));var i=new FormData;for(var r in a)a[r]&&i.append(r,a[r]);o[0].files.length&&p.each(o[0].files,(function(t,e){i.append("files",e)})),p.ajax({method:"POST",url:"".concat(window.location.origin,"/tasks/add"),contentType:!1,processData:!1,data:i,success:function(e){t.closest(".modal").modal("hide"),t[0].reset(),t.find("[data-select]").val(null).trigger("change"),p("#accordion").append(p(e));var a=p(e).attr("data-entity-id");l(p("[data-entity=tasks][data-entity-id=".concat(a,"]")).find("[data-select]"))}})})),window.addEventListener("click",(function(t){var e,a=p(t.target);a.closest("[data-save-task]").length&&function(t){var e=t.closest("[data-entity=tasks]"),a={id:e.attr("data-entity-id"),status:e.find("[data-select]").val().toUpperCase(),subtasks:[],comments:[]};e.find("[data-task-field=text]").each((function(){var t=p(this).attr("data-uf");a[t]=p(this).text()})),"Без времени"===a.expectedTime&&(a.expectedTime=null),e.find("[data-entity=subtasks]").length&&e.find("[data-entity=subtasks]").each((function(){var t={id:p(this).attr("data-entity-id"),complete:p(this).find("[data-entity-field=complete]")[0].checked,name:p(this).find("[data-entity-field=name]").text()};a.subtasks.push(t)})),console.log(a),p.ajax({method:"POST",url:"".concat(window.location.origin,"/tasks/update"),contentType:"application/json",data:JSON.stringify(a),success:function(t){console.log(t),"complete"===t.status.toLowerCase()&&(e.addClass("completed"),e.find("[data-accordion-dropdown]").slideUp(),e.removeClass("active")),v("success","Задача успшено обновлена")}})}(a),a.closest("[data-delete-entity]").length&&function(t){var e=t.closest("[data-entity]"),a=e.attr("data-entity"),n=e.attr("data-entity-id");p.ajax({type:"POST",url:"".concat(window.location.origin,"/").concat(a,"/delete/").concat(n),success:function(t){console.log(t),e.remove(),v("success",t)}})}(a),a.closest("[data-delete-workspace]").length&&(e=window.location.pathname.split("/"),p.ajax({method:"POST",url:"".concat(window.location.origin,"/workspace/delete/").concat(e[2])})),a.closest("[data-workspace-exit]").length&&function(){var t=window.location.pathname.split("/");p.ajax({method:"POST",url:"".concat(window.location.origin,"/workspace/exit/").concat(t[2])})}()})),document.addEventListener("submit",(function(t){if(t.target.hasAttribute("data-add-form")){t.preventDefault();var e={},a=p(t.target),n=a.attr("data-add-form"),o=a.closest("[data-clone-parent]");if(a.find("[data-form-field]").each((function(){var t=p(this).attr("data-form-field");e[t]=p(this).val()})),o.length){var i=a.closest("[data-entity=tasks]");e.taskId=i.attr("data-entity-id")}console.log(e);var r=a.attr("data-form-name");p.ajax({method:"POST",url:"".concat(window.location.origin,"/").concat(n,"/add"),contentType:"application/json",data:JSON.stringify(e),success:function(e){console.log(e),t.target.reset(),o.length&&o.find("[data-clone-container]").append(p(e)),v("success","".concat(r," успешно добавлен"))}})}})),function(){var t=p("[data-add-user]"),e=window.location.pathname.split("/");t.on("submit",(function(a){a.preventDefault();var n={workspaceId:e[2],email:t.find("[data-uf=email]").val(),role:t.find("[data-select]").val()};console.log(n),p.ajax({method:"POST",url:"".concat(window.location.origin,"/role/add"),contentType:"application/json",data:JSON.stringify(n),success:function(e){console.log(e),p("[data-roles-container]").append(p(e)),t[0].reset()},error:function(t){console.log(t),v("error",t.responseText)}})}))}(),function(){var t=p("[data-search-form]"),e=window.location.pathname.split("/");function a(){p.ajax({method:"GET",url:"".concat(window.location.origin,"/tasks/?workspaceId=").concat(e[2],"&page=0"),success:function(e){t.find("input").val("").trigger("change"),p("[data-tasks-container]").empty();var a=p(e).find("#accordion").children();p("[data-tasks-container]").append(a),10===a.length&&p("[data-show-container]").removeClass("hidden")}})}t.on("submit",(function(n){n.preventDefault();var o=t.find("input").val();o?p.ajax({method:"GET",url:"".concat(window.location.origin,"/tasks/search?workspaceId=").concat(e[2],"&query=").concat(o),success:function(t){p("[data-tasks-container]").empty();var e=p(t);p("[data-tasks-container]").append(e),console.log(e.find("[data-select]")),l(e.find("[data-select]")),p("[data-show-container]").addClass("hidden")}}):a()})),t.find("[data-search-clear]").on("click",(function(){a()}))}(),e=1,a=window.location.pathname.split("/"),(n=p("[data-show-button]")).on("click",(function(){p.ajax({method:"GET",url:"".concat(window.location.origin,"/tasks/?workspaceId=").concat(a[2],"&page=").concat(e),success:function(t){var a=p(t).find("#accordion").children();p("[data-tasks-container]").append(a),l(a.find("[data-select]")),p(t).find("[data-show-container]").length?e++:n.closest("[data-show-container]").addClass("hidden")}})}))}));var m=a(993),h=a.n(m),g=a(479),y=a(656);function w(t){return function(t){if(Array.isArray(t))return b(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return b(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return b(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}document.addEventListener("DOMContentLoaded",(function(){var t=document.querySelector("[data-date-picker]");t&&(Object.assign(g.a.locales,y.Z),new g.a(t,{autohide:!0,format:"dd.mm.yyyy",language:"ru"}))})),a(638)((function(){w(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map((function(t){return new(h().Tooltip)(t)}))}))},378:(t,e,a)=>{var n=a(638);n((function(){n("[data-accordion]").length&&window.addEventListener("click",(function(t){!function(t,e){var a=n(e),o=n(t.target);o.closest("[data-accordion-button]").length&&(o.closest(a).toggleClass("active"),o.closest(a).find("[data-accordion-dropdown]").eq(0).slideToggle())}(t,"[data-accordion]")}))}))},309:(t,e,a)=>{var n=a(638);document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".comment").length&&window.addEventListener("click",(function(t){var e=t.target.closest("[data-comment-edit]");if(e){var a=e.closest("[data-entity]"),o=a.querySelector("[data-entity-filed=body]"),i=a.querySelector("[data-comment-col]"),r=a.querySelector("textarea");if(e.classList.contains("active")){if(!r.value||!r.value.match(/\S/gi))return void r.classList.add("error");r.classList.contains("error")&&r.classList.remove("error");var c={id:a.getAttribute("data-entity-id"),body:r.value,taskId:a.closest("[data-entity=tasks]").getAttribute("data-entity-id")};console.log(c),n.ajax({method:"POST",url:"".concat(window.location.origin,"/comments/save"),contentType:"application/json",data:JSON.stringify(c),success:function(t){console.log(t)}}),o.textContent=r.value,i.classList.remove("active")}else i.classList.add("active"),r.value=o.textContent;e.classList.toggle("active")}}))}))},526:()=>{document.addEventListener("DOMContentLoaded",(function(){var t=document.querySelector("[data-add-container]");if(t){var e=document.querySelector("[data-add-button]"),a=t.querySelector("[data-add-item]");e.onclick=function(){var e=a.cloneNode(!0);e.querySelector("input").value="",t.append(e)}}}))}},a={};function n(t){var o=a[t];if(void 0!==o)return o.exports;var i=a[t]={exports:{}};return e[t].call(i.exports,i,i.exports,n),i.exports}n.m=e,t=[],n.O=(e,a,o,i)=>{if(!a){var r=1/0;for(l=0;l<t.length;l++){for(var[a,o,i]=t[l],c=!0,s=0;s<a.length;s++)(!1&i||r>=i)&&Object.keys(n.O).every((t=>n.O[t](a[s])))?a.splice(s--,1):(c=!1,i<r&&(r=i));if(c){t.splice(l--,1);var d=o();void 0!==d&&(e=d)}}return e}i=i||0;for(var l=t.length;l>0&&t[l-1][2]>i;l--)t[l]=t[l-1];t[l]=[a,o,i]},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={143:0};n.O.j=e=>0===t[e];var e=(e,a)=>{var o,i,[r,c,s]=a,d=0;if(r.some((e=>0!==t[e]))){for(o in c)n.o(c,o)&&(n.m[o]=c[o]);if(s)var l=s(n)}for(e&&e(a);d<r.length;d++)i=r[d],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(l)},a=self.webpackChunk=self.webpackChunk||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))})();var o=n.O(void 0,[276],(()=>n(625)));o=n.O(o)})();